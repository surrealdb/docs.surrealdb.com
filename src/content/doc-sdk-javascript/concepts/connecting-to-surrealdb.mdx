---
sidebar_position: 1
sidebar_label: Connecting to SurrealDB
title: JavaScript | SDK | Connecting to SurrealDB
description: The SurrealDB SDK for JavaScript enables simple and advanced querying of a remote or embedded database.
---

import Tabs from "@components/Tabs/Tabs.astro";
import TabItem from "@components/Tabs/TabItem.astro";
import Label from "@components/shared/Label.astro";

# Connecting to SurrealDB

When creating a new connection to a SurrealDB instance, you can choose to connect to a local or remote endpoint, specify a namespace and database pair to use, authenticate with an existing token, authenticate using a pair of credentials, or use advanced custom logic to prepare the connection to the database.

First, you need to initialize a new instance of the Surreal class and connect it to a database endpoint using the `.connect()` method. Then you can specify the connection details such as the URL, namespace, and database. 


## API References

<table>
	<thead>
		<tr>
			<th scope="col">Method</th>
			<th scope="col">Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td scope="row" data-label="Method"><a href="/docs/2.x/sdk/javascript/api/core/surreal#connect"> <code> db.connect(url, options) </code></a></td>
			<td scope="row" data-label="Description">Connects to a local or remote database endpoint</td>
		</tr>
        <tr>
            <td scope="row" data-label="Method"><a href="/docs/2.x/sdk/javascript/api/core/surreal#close"> <code> db.close() </code></a></td>
            <td scope="row" data-label="Description">Closes the persistent connection to the database</td>
        </tr>
        <tr>
            <td scope="row" data-label="Method"><a href="/docs/2.x/sdk/javascript/api/core/surreal#ready"> <code> db.ready </code></a></td>
			<td scope="row" data-label="Description">Waits for the connection to the database to succeed</td>
		</tr>
		<tr>
			<td scope="row" data-label="Method"><a href="/docs/sdk/javascript/api/core/surreal-session#use"> <code> db.use(namespace, database)</code></a></td>
			<td scope="row" data-label="Description">Switch to a specific namespace and database</td>
		</tr>
	</tbody>
</table>

## Opening a connection

Before you can execute any queries, you need to open a connection to a SurrealDB instance. This is done using the `.connect()` method.
This method accepts a connection string and a set of options, including namespace, database, and authentication details.

### Connection string

The connection string represents a URI pointing to a SurrealDB instance. Supported connection protocols include:

- WebSocket (`ws://`) for long lived connections (e.g. backend or frontend applications)
- HTTP (`http://`) for short lived stateless connections (e.g. server-side rendering applications)
- Embedded protocols using the [WebAssembly engine](/docs/sdk/javascript/engines/wasm) or [Node.js engine](/docs/sdk/javascript/engines/node)

<Tabs groupId="connection-string">
	<TabItem value="local" label="Local endpoint" default>
		```ts
		// Over WebSocket
		await db.connect('ws://127.0.0.1:8000');

		// Over HTTP
		await db.connect('http://127.0.0.1:8000');
		```
	</TabItem>
	<TabItem value="remote" label="Remote endpoint">
		```ts
		// Over WebSocket
		await db.connect('wss://cloud.surrealdb.com');

		// Over HTTP
		await db.connect('https://cloud.surrealdb.com');
		```
	</TabItem>
	<TabItem value="embedded" label="Embedded endpoint">
		```ts
		// In-memory database
		await db.connect('mem://');

		// IndexedDB database (browser)
		await db.connect('indxdb://localhost:8000');

		// File-system database (backend)
		await db.connect('rocksdb://localhost:8000');
		```
	</TabItem>
</Tabs>

### Connection options

The optional connection options allow you to further configure the connection to the database, including namespace and database, reconnect logic, and authentication details.

#### Namespace and database

You can directly specify the namespace and database to use using the `namespace` and `database` options. If you do not specify these options, the default namespace and database will be used.

Alternatively, you can use the `.use()` method to switch to a specific namespace and database after connecting.

#### Authentication details

When connecting as a [system user](/docs/surrealdb/security/authentication#system-user) or [token](/docs/surrealdb/security/authentication#token), you can directly pass your credentials to the `auth` option.

While you can use the dedicated `.signin()` method to authenticate, passing the authentication details to the `.connect()` method is the preferred way and allows for automatic reconnecting.

#### Reconnection behavior

You can configure the reconnection behavior using the `reconnect` option. The SDK features a built-in reconnection mechanism for WebSocket connections that automatically reconnects to the database if the connection is lost.
Additionally, you can configure the behavior with exponential backoff and jitter to prevent overwhelming the database with reconnection attempts.

| Option                | Description                                              |
|-----------------------|----------------------------------------------------------|
| `enabled`             | Enable automatic reconnection                            |
| `attempts`            | Maximum reconnection attempts (`-1` for unlimited)       |
| `retryDelay`          | Initial delay before reconnecting (ms)                   |
| `retryDelayMax`       | Maximum delay between attempts (ms)                      |
| `retryDelayMultiplier`| Multiply delay after each failed attempt                 |
| `retryDelayJitter`    | Random offset percentage for delays                      |

### Effect of connection protocol on token & session duration

The connection protocol you choose affects how authentication tokens and sessions work

- **Websocket** connections (`ws://`, `wss://`) you open a single long-lived stateful connection where after the initial authentication, the session duration applies and if not specified, defaults to `NONE` meaning that the session never expires unless otherwise specified. 
- **HTTP** connection (`http://`, `https://`), every request you make is short-lived and stateless, requiring you to authenticate every request individually for which the token is used, creating a short lived session. Hence, the token duration which defaults to 1 hour applies.

You can extend the session duration of a token or a session by setting the `DURATION` clause when creating a new access method with the [`DEFINE ACCESS METHOD`](/docs/surrealql/statements/define/access) statement or when defining a new user with the [`DEFINE USER`](/docs/surrealql/statements/define/user) statement.
Learn more about token and session duration in our [security best practices](/docs/surrealdb/security/security-best-practices#expiration) documentation.

TODO: FROM HERE

## `.use()`

Depending on the complexity of your use case, you can switch to a specific namespace and database using the `.use()` method. This is particularly useful if you want to switch to a different setup after connecting. You can also stay in the same namespace but switch to a different database. 

Learn more about the `.use()` method in the [API reference](/docs/2.x/sdk/javascript/api/core/surreal-session#use).

### Example usage
```ts
await db.use({ namespace: 'surrealdb', database: 'docs' });
```

<br />

## `.ready` property

The `.ready` propery is used to wait for the connection to the database to succeed. This is particularly useful if you want to ensure that the connection is established before executing any queries.

> [!IMPORTANT]
> Use this property after `.connect()` to ensure that the connection is established before executing any queries.
```ts
await db.ready;
```

<br />

## `.close()`

The `.close()` method closes the persistent connection to the database. You should always call this method when you are done with the connection to free up resources.

```ts
await db.close();
```


## Example

Here is an example of the `.connect()`, `.use()`, `.ready`, and `.close()` methods in action.

```ts title="Example"
import Surreal from "surrealdb";

// Define the database configuration interface
interface DbConfig {
  url: string;
  namespace: string;
  database: string;
}

// Define the default database configuration
const DEFAULT_CONFIG: DbConfig = {
  url: "http://127.0.0.1:8000/rpc",
  namespace: "test",
  database: "test",
};

// Define the function to get the database instance
export async function getDb(config: DbConfig = DEFAULT_CONFIG): Promise<Surreal> {
  const db = new Surreal();

  try {
    await db.connect(config.url);
    await db.use({ namespace: config.namespace, database: config.database });
    return db;
  } catch (err) {
    console.error("Failed to connect to SurrealDB:", err instanceof Error ? err.message : String(err));
    await db.close();
    throw err;
  }
}
```
