---
sidebar_position: 1
sidebar_label: ALTER
title: ALTER statement | SurrealQL
description: The ALTER statement can be used to change authentication access and behaviour, global parameters, table configurations, table events, schema definitions, and indexes.
---
import Since from '@components/shared/Since.astro'
import RailroadDiagram from '@components/RailroadDiagram.astro'
import Tabs from '@components/Tabs/Tabs.astro'
import TabItem from '@components/Tabs/TabItem.astro'

# `ALTER` statement

<Since v="v2.0.0" />

The `ALTER` statement can be used to change definitions for defined resources.


> [!NOTE]
> Currently, the `ALTER` statement only supports a limited number of resources: tables, and indexes to prepare them for removal. `ALTER` will be expanded to include other resources. In the meantime, the `OVERWRITE` clause can be used in other `DEFINE` statements to redefine resources that have already been defined.

<Tabs syncKey="alter-statement">
  <TabItem label="SurrealQL Syntax">

```syntax title="SurrealQL Syntax"
ALTER [
	| TABLE [ IF EXISTS ] @name
		[ DROP ]
		[ SCHEMAFULL | SCHEMALESS ]
		[ PERMISSIONS [ NONE | FULL
			| FOR select @expression
			| FOR create @expression
			| FOR update @expression
			| FOR delete @expression
		] ]
    [ CHANGEFEED @duration ]
  | INDEX @name ON TABLE @table PREPARE REMOVE
    [ DROP ] [ COMMENT @string | CHANGEFEED ]
  ]
```

  </TabItem>
  <TabItem label="Railroad Diagram">

export const alterAst = {
  type: "Diagram",
  padding: [10, 20, 10, 20],
  children: [
    { type: "Sequence", children: [
      { type: "Terminal", text: "ALTER" },
      { type: "Choice", index: 0, children: [
        // ALTER TABLE branch
        { type: "Sequence", children: [
          { type: "Terminal", text: "TABLE" },
          { type: "Optional", child: { type: "Sequence", children: [ { type: "Terminal", text: "IF" }, { type: "Terminal", text: "EXISTS" } ] } },
          { type: "NonTerminal", text: "@name" },
          { type: "Optional", child: { type: "Terminal", text: "DROP" } },
          { type: "Optional", child: { type: "Choice", index: 1, children: [ { type: "Terminal", text: "SCHEMAFULL" }, { type: "Terminal", text: "SCHEMALESS" } ] } },
          { type: "Optional", child: { type: "Sequence", children: [ { type: "Terminal", text: "PERMISSIONS" }, { type: "Choice", index: 1, children: [
            { type: "Terminal", text: "NONE" },
            { type: "Terminal", text: "FULL" },
            { type: "Sequence", children: [ { type: "Terminal", text: "FOR" }, { type: "Terminal", text: "select" }, { type: "NonTerminal", text: "@expression" } ] },
            { type: "Sequence", children: [ { type: "Terminal", text: "FOR" }, { type: "Terminal", text: "create" }, { type: "NonTerminal", text: "@expression" } ] },
            { type: "Sequence", children: [ { type: "Terminal", text: "FOR" }, { type: "Terminal", text: "update" }, { type: "NonTerminal", text: "@expression" } ] },
            { type: "Sequence", children: [ { type: "Terminal", text: "FOR" }, { type: "Terminal", text: "delete" }, { type: "NonTerminal", text: "@expression" } ] }
          ] } ] } },
          { type: "Optional", child: { type: "Terminal", text: "CHANGEFEED" } }
        ] },
        // ALTER INDEX ... PREPARE REMOVE branch
        { type: "Sequence", children: [
          { type: "Terminal", text: "INDEX" },
          { type: "NonTerminal", text: "@index" },
          { type: "Terminal", text: "ON" },
          { type: "Terminal", text: "TABLE" },
          { type: "NonTerminal", text: "@table" },
          { type: "Terminal", text: "PREPARE" },
          { type: "Terminal", text: "REMOVE" }
        ] }
      ] },
      // COMMENT is optional and available for both branches
      { type: "Optional", child: { type: "Sequence", children: [
        { type: "Optional", child: { type: "Terminal", text: "DROP" } },
        { type: "Terminal", text: "COMMENT" },
        { type: "NonTerminal", text: "@string" }
      ] } }
    ]}
  ]
};



<RailroadDiagram ast={alterAst} className="my-6" />

  </TabItem>
</Tabs>

## Modify a table schema

When starting a new project, you may require a table to be schemaless to allow for flexibility in the data structure. However, as the project progresses, you may want to lock down the schema to prevent new fields from being added. This can be done using the `ALTER` statement.

> [!NOTE]
> To see the already defined items that can be modified with `ALTER`, use the [INFO](/docs/surrealql/statements/info) statement (`INFO FOR ROOT`, `INFO FOR NAMESPACE`, or `INFO FOR DATABASE`).

An example of `ALTER` to modify an existing table:
```surql
/**[test]

[[test.results]]
value = "NONE"

[[test.results]]
value = "NONE"

[[test.results]]
value = "[{ id: user:317esn5r3spd4em0lfze, name: 'LordofSalty' }]"
skip-record-id-key = true

[[test.results]]
value = "NONE"

*/

DEFINE TABLE user SCHEMALESS;
DEFINE FIELD name ON TABLE user TYPE string;
CREATE user SET name = "LordofSalty";

-- Now make it schemafull to ensure that no other fields can be used
ALTER TABLE user SCHEMAFULL;
```

## Modify table permissions

You can also use the `ALTER` statement to change a table's permissions. An `ALTER` statement only needs to include the items to be altered, not the entire definition.

```surql
/**[test]

[[test.results]]
value = "NONE"

[[test.results]]
value = "NONE"

*/

-- Will show up as DEFINE TABLE user TYPE ANY SCHEMAFULL PERMISSIONS NONE
DEFINE TABLE user SCHEMAFULL;

-- Now defined as DEFINE TABLE user TYPE ANY SCHEMAFULL PERMISSIONS FULL
ALTER TABLE user PERMISSIONS FOR create FULL;
```

## Using `IF EXISTS` clause

You can use the' IF EXISTS' clause to prevent an error from occurring when trying to alter a table that does not exist.

```surql
/**[test]

[[test.results]]
value = "NONE"

*/

ALTER TABLE IF EXISTS user SCHEMAFULL;
```

## ALTER INDEX PREPARE REMOVE

<Since v="v3.0.0-beta" />

As the name implies, an `ALTER INDEX PREPARE REMOVE` statement alters an index to prepare it for removal. This statement sets up a step in which the index has been decommissioned (prepared for removal), but not yet removed. At this point, `SELECT` queries along with the `EXPLAIN` clause to monitor query performance without the index.

```surql
-- 1. Decommission the index
ALTER INDEX my_index ON my_table PREPARE REMOVE;

-- 2. Monitor query performance and verify queries still work
SELECT ... FROM my_table EXPLAIN;

-- 3. If satisfied, permanently remove the index
REMOVE INDEX my_index ON my_table;
```

If removing the index is no longer desired, it can be restored to a useful state by using a [REBUILD INDEX](/docs/surrealql/statements/rebuild) statement.

```surql
REBUILD INDEX my_index ON my_table;
```