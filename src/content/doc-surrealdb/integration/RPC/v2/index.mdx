---
sidebar_position: 2
sidebar_label: v2 Protocol
title: RPC Protocol | Integration
description: The RPC protocol allows for easy bidirectional communication with SurrealDB.
---

import Since from '@components/shared/Since.astro'
import Label from "@components/shared/Label.astro";

# RPC v2 Protocol

The introduction of RPC v2 allowed for the implementation of breaking changes, enabling enhanced features for seamless communication with SurrealDB and ensuring efficient, secure interactions over HTTP and WebSocket.

<br/>

## Key Changes in v2

Version 2 brings significant enhancements compared to v1:

*   **Enhanced Method Parameters:** Key data manipulation and retrieval methods (`select`, `insert`, `create`, `upsert`, `update`, `relate`, `delete`) now accept an optional final object parameter. This object allows specifying common statement clauses (like `WHERE`, `LIMIT`, `TIMEOUT`, etc.), providing control previously limited to direct SQL execution.
    *   **Data Handling:** Specify how data is processed during the operation.
    *   **Output Control:** Define the format of the results returned by the method.
    *   **Query Constraints:** Apply conditions, limits, starting points...
    *   **Execution Control:** Set execution timeouts, define <a href="#session-variables">request-scoped variables</a>, and handle record versioning.
*   **Method Consolidation:** The `merge` and `patch` methods from v1 have been consolidated into the `update` method. 

These changes provide greater flexibility and power when interacting with SurrealDB via the RPC protocol.

<br/>

## Supported methods

You can use the RPC protocol to perform the following actions:
<table>
    <tbody>
        <tr>
            <td scope="row" data-label="Title" colspan="2">Connection and Session Management</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/ping"><code>ping</code></a></td>
            <td scope="row" data-label="Description">Checks the connection to the server</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/info"><code>info</code></a></td>
            <td scope="row" data-label="Description">Returns the record of an authenticated record user</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/use"><code>use [ ns, db ]</code></a></td>
            <td scope="row" data-label="Description">Specifies or unsets the namespace and/or database for the current connection</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/reset"><code>reset</code></a></td>
            <td scope="row" data-label="Description">Resets the current session, clears live queries, and restores the session to its default state</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/version"><code>version</code></a></td>
            <td scope="row" data-label="Description">Returns version information about the database/server</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/version"><code>set</code></a></td>
            <td scope="row" data-label="Description">Define a variable on the current connection</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/version"><code>unset</code></a></td>
            <td scope="row" data-label="Description">Remove a variable from the current connection</td>
        </tr>


        <tr>
            <td scope="row" data-label="Title" colspan="2">Authentication and Authorization</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/signup"><code>signup [ NS, DB, AC, ... ]</code></a></td>
            <td scope="row" data-label="Description">Signs up a user using the SIGNUP query defined in a record access method</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/signin"><code>signin [ NS, DB, AC, ... ]</code></a></td>
            <td scope="row" data-label="Description">Signs in a root, namespace, database, or record user against SurrealDB</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/authenticate"><code>authenticate [ token ]</code></a></td>
            <td scope="row" data-label="Description">Authenticates a user against SurrealDB with a token</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/invalidate"><code>invalidate</code></a></td>
            <td scope="row" data-label="Description">Invalidates a user's session for the current connection</td>
        </tr>


        <tr>
            <td scope="row" data-label="Title" colspan="2">Data Retrieval</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/select"><code>select [ thing ]</code></a></td>
            <td scope="row" data-label="Description">Selects either all records in a table or a single record</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/graphql"><code>graphql [ query, options? ]</code></a></td>
            <td scope="row" data-label="Description">Executes GraphQL queries against the database</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/live"><code>live</code></a></td>
            <td scope="row" data-label="Description">Initiate a live query</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/kill"><code>kill</code></a></td>
            <td scope="row" data-label="Description">Kill an active live query</td>
        </tr>

        <tr>
            <td scope="row" data-label="Title" colspan="2">Data Manipulation</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/insert"><code>insert [ thing, data ]</code></a></td>
            <td scope="row" data-label="Description">Inserts one or multiple records into a table</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/create"><code>create [ thing, data ]</code></a></td>
            <td scope="row" data-label="Description">Creates a record with a random or specified ID</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/upsert"><code>upsert [ thing, data ]</code></a></td>
            <td scope="row" data-label="Description">Replaces either all records in a table or a single record with specified data</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/update"><code>update [ thing, data ]</code></a></td>
            <td scope="row" data-label="Description">Modifies either all records in a table or a single record with specified data</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/delete"><code>delete [ thing ]</code></a></td>
            <td scope="row" data-label="Description">Deletes either all records in a table or a single record</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/relate"><code>relate [ in, relation, out, data? ]</code></a></td>
            <td scope="row" data-label="Description">Creates graph relationships between records</td>
        </tr>


        <tr>
            <td scope="row" data-label="Title" colspan="2">Custom Functionality</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/query"><code>query [ sql, vars ]</code></a></td>
            <td scope="row" data-label="Description">Executes a custom query with optional variables</td>
        </tr>
        <tr>
            <td scope="row" data-label="Function"><a href="./v2/run"><code>run [ func_name, version, args ]</code></a></td>
            <td scope="row" data-label="Description">Executes built-in functions, custom functions, or machine learning models with optional arguments</td>
        </tr>
    </tbody>
</table>

## Session Variables
SurrealDB's session variables provide a robust mechanism for managing session-specific data. Think of them as temporary storage tied directly to a user's active connection, ideal for tasks like maintaining application state, storing user preferences, or holding temporary data relevant only to the current session.

A key characteristic of session variables is their scope: they are strictly confined to the individual connection. This isolation ensures that one user's session data remains private and does not interfere with others, allowing for personalized experiences within a multi-user environment.

You can interact with session variables in the following ways:

1.  **Explicit Session-Wide Management:**
    *   Use the [`set`](./v2/set) method to define a new variable or update an existing one within the current session. This variable will persist for the duration of the connection.
    *   Use the [`unset`](./v2/unset) method to remove a previously defined variable from the session.
    *   The [`reset`](./v2/reset) method, in addition to its other functions, clears *all* currently defined session variables, restoring the session's variable state.

2.  **Implicit Request-Scoped Management:**
    *   Several methods, including [`query`](./v2/query), [`select`](./v2/select), [`insert`](./v2/insert), [`create`](./v2/create), [`upsert`](./v2/upsert), [`update`](./v2/update), [`relate`](./v2/relate), and [`delete`](./v2/delete), accept an optional `vars` parameter. This parameter is an object containing key-value pairs, where each key represents the variable name (without the leading `$`) and the value is the data to be assigned.
    *   Variables passed via this parameter are defined *only* for the execution context of that specific method call. They temporarily override any session-wide variable with the same name for that request but do not permanently alter the session state. These variables are automatically discarded once the method execution completes.

To utilize a session variable within a query or method, prefix its name with a dollar sign (`$`), for example, `$user_id`.