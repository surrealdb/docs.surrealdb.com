---
sidebar_position: 7
sidebar_label: Transactions
title: Python | SDK | Transactions
description: The Python SDK supports client-side transactions for executing multiple operations atomically over WebSocket connections.
---

import Tabs from "@components/Tabs/Tabs.astro";
import TabItem from "@components/Tabs/TabItem.astro";

# Transactions

The Python SDK supports client-side transactions that group multiple operations into a single atomic unit. All operations within a transaction either succeed together when committed or are rolled back entirely when cancelled. Transactions are scoped to a session and execute over a WebSocket connection.

This page covers how to create, execute, commit, cancel, and handle errors within transactions.

> [!NOTE]
> Transactions require a WebSocket connection (`ws://` or `wss://`) and must be created from a session. HTTP and embedded connections do not support transactions.

## API References

<table>
	<thead>
		<tr>
			<th scope="col">Method</th>
			<th scope="col">Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td scope="row" data-label="Method"><a href="/docs/sdk/python/api/core/surreal-session#begin-transaction"><code>session.begin_transaction()</code></a></td>
			<td scope="row" data-label="Description">Begins a new transaction within the session</td>
		</tr>
		<tr>
			<td scope="row" data-label="Method"><a href="/docs/sdk/python/api/core/surreal-transaction#commit"><code>txn.commit()</code></a></td>
			<td scope="row" data-label="Description">Commits all operations in the transaction, making changes permanent</td>
		</tr>
		<tr>
			<td scope="row" data-label="Method"><a href="/docs/sdk/python/api/core/surreal-transaction#cancel"><code>txn.cancel()</code></a></td>
			<td scope="row" data-label="Description">Cancels the transaction and rolls back all changes</td>
		</tr>
	</tbody>
</table>

## Creating a transaction

To create a transaction, first open a session with `.new_session()` on the connection, then call `.begin_transaction()` on the session. The returned transaction object provides the same data manipulation methods as the main connection, but all operations are held until the transaction is committed or cancelled.

<Tabs syncKey="python-sync-async">
	<TabItem value="sync" label="Synchronous" default>
		```python
		from surrealdb import Surreal

		with Surreal("ws://localhost:8000") as db:
		    db.use("surrealdb", "docs")
		    db.signin({"username": "root", "password": "root"})

		    session = db.new_session()
		    session.use("surrealdb", "docs")

		    txn = session.begin_transaction()
		```
	</TabItem>
	<TabItem value="async" label="Asynchronous">
		```python
		from surrealdb import AsyncSurreal

		async with AsyncSurreal("ws://localhost:8000") as db:
		    await db.use("surrealdb", "docs")
		    await db.signin({"username": "root", "password": "root"})

		    session = await db.new_session()
		    await session.use("surrealdb", "docs")

		    txn = await session.begin_transaction()
		```
	</TabItem>
</Tabs>

## Executing operations within a transaction

Once a transaction is created, use its methods — such as `.query()`, `.create()`, `.select()`, `.update()`, and `.delete()` — to perform operations. These operations are buffered within the transaction scope and are not visible to other connections or sessions until the transaction is committed.

<Tabs syncKey="python-sync-async">
	<TabItem value="sync" label="Synchronous" default>
		```python
		txn.create("users", {
		    "name": "Alice",
		    "email": "alice@example.com",
		    "age": 30,
		})

		txn.create("users", {
		    "name": "Bob",
		    "email": "bob@example.com",
		    "age": 25,
		})

		result = txn.query("SELECT * FROM users")
		```
	</TabItem>
	<TabItem value="async" label="Asynchronous">
		```python
		await txn.create("users", {
		    "name": "Alice",
		    "email": "alice@example.com",
		    "age": 30,
		})

		await txn.create("users", {
		    "name": "Bob",
		    "email": "bob@example.com",
		    "age": 25,
		})

		result = await txn.query("SELECT * FROM users")
		```
	</TabItem>
</Tabs>

Refer to the [SurrealTransaction API reference](/docs/sdk/python/api/core/surreal-transaction) for the full list of methods available on the transaction object.

## Committing a transaction

Calling `.commit()` makes all operations in the transaction permanent. After committing, the changes become visible to other connections and sessions.

<Tabs syncKey="python-sync-async">
	<TabItem value="sync" label="Synchronous" default>
		```python
		txn.commit()
		```
	</TabItem>
	<TabItem value="async" label="Asynchronous">
		```python
		await txn.commit()
		```
	</TabItem>
</Tabs>

A transaction can only be committed once. After committing, the transaction object should not be reused.

## Cancelling a transaction

Calling `.cancel()` discards all operations in the transaction and rolls back any changes. The database state is restored to what it was before the transaction began.

<Tabs syncKey="python-sync-async">
	<TabItem value="sync" label="Synchronous" default>
		```python
		txn.cancel()
		```
	</TabItem>
	<TabItem value="async" label="Asynchronous">
		```python
		await txn.cancel()
		```
	</TabItem>
</Tabs>

## Handling errors in transactions

Use a `try`/`except` block to ensure that a transaction is cancelled if any operation fails. This prevents partial changes from being committed to the database.

<Tabs syncKey="python-sync-async">
	<TabItem value="sync" label="Synchronous" default>
		```python
		from surrealdb import Surreal

		with Surreal("ws://localhost:8000") as db:
		    db.use("surrealdb", "docs")
		    db.signin({"username": "root", "password": "root"})

		    session = db.new_session()
		    session.use("surrealdb", "docs")

		    txn = session.begin_transaction()

		    try:
		        txn.create("users", {"name": "Alice", "age": 30})
		        txn.create("users", {"name": "Bob", "age": 25})
		        txn.commit()
		    except Exception:
		        txn.cancel()
		        raise
		```
	</TabItem>
	<TabItem value="async" label="Asynchronous">
		```python
		from surrealdb import AsyncSurreal

		async with AsyncSurreal("ws://localhost:8000") as db:
		    await db.use("surrealdb", "docs")
		    await db.signin({"username": "root", "password": "root"})

		    session = await db.new_session()
		    await session.use("surrealdb", "docs")

		    txn = await session.begin_transaction()

		    try:
		        await txn.create("users", {"name": "Alice", "age": 30})
		        await txn.create("users", {"name": "Bob", "age": 25})
		        await txn.commit()
		    except Exception:
		        await txn.cancel()
		        raise
		```
	</TabItem>
</Tabs>

The `raise` at the end re-raises the original exception after cancelling the transaction, so the error is still visible to the caller.

## Learn more

- [SurrealTransaction API reference](/docs/sdk/python/api/core/surreal-transaction) for transaction method signatures
- [SurrealSession API reference](/docs/sdk/python/api/core/surreal-session) for session management
- [Multiple sessions](/docs/sdk/python/concepts/multiple-sessions) for session setup
- [Error handling](/docs/sdk/python/concepts/error-handling) for error recovery patterns
