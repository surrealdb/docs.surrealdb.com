---
import Image, { type Props as ImageProps } from '@components/Image.astro';
import { cn } from '@src/util/tailwind';
import { Icon } from 'astro-icon/components';

type Props = {
    title: string;
    description?: string;
    icon?: ImageProps['src'];
    iconName?: string;
    href?: string;
    active?: boolean;
    external?: boolean;
    dataUrl?: string;
};

const { title, description, icon, iconName, href, active, external, dataUrl } =
    Astro.props;

const Element = href ? 'a' : 'div';
const hasCustomIcon = Astro.slots.has('icon');
const hasAnyIcon = hasCustomIcon || iconName || icon;
---

<Element 
	class={cn(
		"group flex items-center gap-3 py-2 px-3 rounded-lg w-full transition-colors hover:bg-code cursor-pointer", 
		dataUrl && "copy-markdown-item"
	)} 
	href={href} 
	data-url={dataUrl}
	target={external ? "_blank" : undefined}
	rel={external ? "noopener noreferrer" : undefined}
>
	{hasAnyIcon && (
		<div class="flex-shrink-0 w-8 h-8 rounded-lg bg-background flex items-center justify-center border border-border group-hover:border-surreal-pink/50 transition-colors">
			{hasCustomIcon ? (
				<div class="w-4 h-4 text-text/70 group-hover:text-text transition-colors [&>svg]:w-full [&>svg]:h-full">
					<slot name="icon" />
				</div>
			) : iconName ? (
				<Icon name={iconName} class="w-4 h-4 text-text/70 group-hover:text-text transition-colors" />
			) : icon ? (
				<Image src={icon} alt={title} class="size-4" />
			) : null}
		</div>
	)}
	<div class="flex flex-col flex-1 min-w-0">
		<span class={cn("text-sm text-text/80 group-hover:text-text transition-colors", active && "text-surreal-pink")}>
			{title}
		</span>
		{description && (
			<span class="text-xs text-text/50 group-hover:text-text/60 transition-colors truncate">
				{description}
			</span>
		)}
	</div>
	{external && (
		<Icon name="fa6-solid:arrow-up-right-from-square" class="w-3 h-3 flex-shrink-0 text-text/40 group-hover:text-text/60 transition-colors" />
	)}
</Element>